<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Eleições 2026 • Apuração Ao Vivo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Oswald:wght@500;700&display=swap" rel="stylesheet">

<style>
:root {
  --bg-dark: #0f172a;
  --bg-card: #1e293b;
  --text-main: #f8fafc;
  --text-muted: #94a3b8;
  --accent: #3b82f6;
  --winner: #10b981;
  --danger: #ef4444;
  --gold: #fbbf24;
  --card-height: 80px;
  --gap: 12px;
}

* { box-sizing: border-box; margin: 0; padding: 0; user-select: none; }

body {
  background-color: var(--bg-dark);
  color: var(--text-main);
  font-family: 'Inter', sans-serif;
  overflow-x: hidden;
  min-height: 100vh;
  padding-bottom: 80px; /* Space for news ticker */
}

/* --- HEADER TV STYLE --- */
header {
  background: linear-gradient(90deg, #0f172a 0%, #1e3a8a 100%);
  border-bottom: 4px solid var(--gold);
  padding: 15px 0;
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
  position: relative;
  z-index: 20;
}

.header-container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.brand { display: flex; align-items: center; gap: 15px; }
.brand-icon { font-size: 2.5rem; color: var(--gold); text-shadow: 0 0 15px rgba(251, 191, 36, 0.5); }
.brand-text h1 { font-family: 'Oswald', sans-serif; font-size: 1.8rem; text-transform: uppercase; letter-spacing: 1px; line-height: 1; }
.brand-text span { font-size: 0.8rem; color: var(--accent); letter-spacing: 3px; text-transform: uppercase; font-weight: 800; }

.live-indicator {
  background: rgba(239, 68, 68, 0.2);
  border: 1px solid var(--danger);
  color: var(--danger);
  padding: 5px 15px;
  border-radius: 4px;
  font-weight: 800;
  font-size: 0.8rem;
  display: flex;
  align-items: center;
  gap: 8px;
  animation: pulseRed 2s infinite;
}
.live-dot { width: 8px; height: 8px; background: var(--danger); border-radius: 50%; }

/* --- CONTROLS --- */
.controls {
  display: flex;
  gap: 10px;
  background: rgba(255,255,255,0.05);
  padding: 10px;
  border-radius: 10px;
  margin: 20px auto;
  max-width: 1400px;
  width: 95%;
  justify-content: center;
  backdrop-filter: blur(10px);
}

button {
  border: none;
  padding: 12px 24px;
  border-radius: 6px;
  font-weight: 700;
  text-transform: uppercase;
  cursor: pointer;
  font-family: 'Oswald', sans-serif;
  letter-spacing: 1px;
  transition: all 0.2s;
  color: white;
}

#btnPause { background: #334155; }
#btnChaos { 
  background: linear-gradient(135deg, #b91c1c 0%, #ef4444 100%);
  box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);
  position: relative;
  overflow: hidden;
}
#btnChaos:active { transform: scale(0.95); }
#btnChaos::after {
  content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
  background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent);
  transform: rotate(45deg);
  animation: shimmer 3s infinite;
}

/* --- DASHBOARD --- */
.dashboard {
  max-width: 1400px;
  margin: 0 auto;
  padding: 20px;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 30px;
}

.panel {
  background: var(--bg-card);
  border-radius: 12px;
  padding: 20px;
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
  border: 1px solid rgba(255,255,255,0.05);
  position: relative;
}

.panel-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-end;
  margin-bottom: 20px;
  border-bottom: 2px solid rgba(255,255,255,0.1);
  padding-bottom: 10px;
}

.panel-title { font-family: 'Oswald', sans-serif; font-size: 1.5rem; color: var(--text-main); }
.panel-stats { color: var(--text-muted); font-size: 0.9rem; }
.panel-stats span { color: var(--gold); font-weight: bold; }

/* --- LISTA DE CANDIDATOS (ANIMADA) --- */
.candidates-wrapper {
  position: relative;
  /* Altura baseada em 8 candidatos * altura do card + gaps */
  height: 600px; 
}

.candidate-card {
  position: absolute;
  left: 0;
  right: 0;
  height: var(--card-height);
  background: rgba(30, 41, 59, 0.7);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 8px;
  display: flex;
  align-items: center;
  padding: 0 15px;
  transition: top 0.6s cubic-bezier(0.34, 1.56, 0.64, 1), transform 0.3s, background 0.3s;
  backdrop-filter: blur(5px);
}

/* O 1º lugar ganha destaque */
.candidate-card.rank-1 {
  background: linear-gradient(90deg, rgba(16, 185, 129, 0.1), rgba(16, 185, 129, 0.05));
  border: 1px solid var(--winner);
  z-index: 10;
  box-shadow: 0 0 15px rgba(16, 185, 129, 0.2);
}
.candidate-card.rank-1 .c-pos { background: var(--winner); color: #fff; }

.c-pos {
  width: 30px; height: 30px;
  background: #334155;
  border-radius: 50%;
  display: flex; justify-content: center; align-items: center;
  font-weight: 700; font-size: 0.9rem;
  margin-right: 15px;
}

.c-img {
  width: 50px; height: 50px;
  background: #475569;
  border-radius: 50%;
  margin-right: 15px;
  display: flex; justify-content: center; align-items: center;
  font-size: 1.5rem; color: #94a3b8;
}

.c-info { flex: 1; }
.c-name { font-weight: 700; font-size: 1.1rem; display: block; }
.c-party { font-size: 0.8rem; color: var(--text-muted); background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 4px; margin-top: 2px; display: inline-block;}

.c-votes { text-align: right; }
.c-pct { font-size: 1.4rem; font-weight: 800; color: var(--text-main); display: block; }
.c-abs { font-size: 0.85rem; color: var(--text-muted); font-variant-numeric: tabular-nums; }

.bar-container {
  position: absolute;
  bottom: 0; left: 0; right: 0;
  height: 4px;
  background: transparent;
  overflow: hidden;
  border-radius: 0 0 8px 8px;
}
.bar-fill {
  height: 100%;
  background: var(--accent);
  transition: width 0.5s ease;
  width: 0%;
  box-shadow: 0 0 10px var(--accent);
}
.rank-1 .bar-fill { background: var(--winner); box-shadow: 0 0 10px var(--winner); }

/* --- NEWS TICKER --- */
.news-ticker {
  position: fixed;
  bottom: 0; left: 0; width: 100%;
  background: #000;
  border-top: 2px solid var(--gold);
  color: white;
  display: flex;
  height: 50px;
  z-index: 100;
}
.ticker-label {
  background: var(--gold);
  color: #000;
  padding: 0 20px;
  display: flex; align-items: center;
  font-weight: 900;
  font-family: 'Oswald', sans-serif;
  text-transform: uppercase;
  font-size: 1.1rem;
}
.ticker-content {
  flex: 1;
  display: flex; align-items: center;
  overflow: hidden;
  white-space: nowrap;
  padding-left: 20px;
  font-size: 1.1rem;
}
.ticker-item {
  animation: slideLeft 20s linear infinite;
  display: inline-block;
}

/* --- OVERLAY DE REVIRAVOLTA --- */
.twist-overlay {
  position: fixed;
  inset: 0;
  background: rgba(220, 38, 38, 0.2);
  z-index: 99;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.2s;
  display: flex; justify-content: center; align-items: center;
}
.twist-overlay.active { opacity: 1; animation: shake 0.5s ease-in-out; }
.twist-text {
  font-family: 'Oswald', sans-serif;
  font-size: 5rem;
  color: white;
  text-transform: uppercase;
  background: var(--danger);
  padding: 20px 40px;
  transform: rotate(-5deg);
  box-shadow: 0 20px 50px rgba(0,0,0,0.5);
  border: 4px solid white;
}

/* --- ANIMATIONS --- */
@keyframes shimmer { 0% { left: -50%; } 100% { left: 150%; } }
@keyframes pulseRed { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
@keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-10px); } 75% { transform: translateX(10px); } }
@keyframes slideLeft { from { transform: translateX(100vw); } to { transform: translateX(-100%); } }

@media (max-width: 900px) {
  .dashboard { grid-template-columns: 1fr; }
  .twist-text { font-size: 3rem; }
}
</style>
</head>
<body>

<header>
  <div class="header-container">
    <div class="brand">
      <i class="fas fa-globe-americas brand-icon"></i>
      <div class="brand-text">
        <h1>Apuração 2026</h1>
        <span>Central de Dados</span>
      </div>
    </div>
    <div class="live-indicator">
      <div class="live-dot"></div> AO VIVO
    </div>
  </div>
</header>

<div class="controls">
  <button id="btnPause"><i class="fas fa-pause"></i> Pausar</button>
  <button id="btnChaos"><i class="fas fa-bolt"></i> FORÇAR VIRADA AGORA</button>
</div>

<div class="dashboard">
  <div class="panel">
    <div class="panel-header">
      <div class="panel-title">PREFEITURA MUNICIPAL</div>
      <div class="panel-stats">
        Urnas: <span id="urnasPref">0%</span> • Votos: <span id="votosPref">0</span>
      </div>
    </div>
    <div class="candidates-wrapper" id="containerPref">
      </div>
  </div>

  <div class="panel">
    <div class="panel-header">
      <div class="panel-title">CÂMARA MUNICIPAL</div>
      <div class="panel-stats">
        Vagas: <span>5</span> • Urnas: <span id="urnasVer">0%</span>
      </div>
    </div>
    <div class="candidates-wrapper" id="containerVer">
      </div>
  </div>
</div>

<div class="news-ticker">
  <div class="ticker-label">BREAKING NEWS</div>
  <div class="ticker-content">
    <span id="tickerText" class="ticker-item">ACOMPANHE A APURAÇÃO EM TEMPO REAL • URNAS COMEÇAM A CHEGAR NO CENTRO DE APURAÇÃO • EXPECTATIVA DE RECORDE DE VOTOS...</span>
  </div>
</div>

<div class="twist-overlay" id="fxOverlay">
  <div class="twist-text">VIRADA!</div>
</div>

<script>
// --- DADOS INICIAIS ---
// IDs únicos para rastrear animação
const prefeitos = [
  { id: 'p1', nome: "Rodrigo Manga", numero: 28, partido: "PRTB", votos: 4500, cor: "#28a745" },
  { id: 'p2', nome: "Ryan Everton", numero: 22, partido: "PL", votos: 4400, cor: "#0d6efd" }, // Começa perto pra ter briga
  { id: 'p3', nome: "Arthur Silva", numero: 17, partido: "PSL", votos: 3200, cor: "#dc3545" },
  { id: 'p4', nome: "Gabriel Arraes", numero: 77, partido: "SD", votos: 2800, cor: "#0dcaf0" },
  { id: 'p5', nome: "Javier Mendonza", numero: 35, partido: "PMB", votos: 1500, cor: "#ffc107" },
  { id: 'p6', nome: "Noah D.", numero: 10, partido: "RPL", votos: 1200, cor: "#fd7e14" },
  { id: 'p7', nome: "Henrique Martins", numero: 15, partido: "MDB", votos: 800, cor: "#6c757d" }
  { id: 'p8', nome: "Fernando Hauss", numero: 43, partido: "PV", votos: 211, cor: "#bab86c" }

];

const vereadores = [
  { id: 'v1', nome: "Arthur A.", numero: 38000, partido: "UDB", votos: 1500 },
  { id: 'v2', nome: "Nicollas C.", numero: 77400, partido: "SD", votos: 1450 },
  { id: 'v3', nome: "Vitor H.", numero: 22222, partido: "PL", votos: 1300 },
  { id: 'v4', nome: "Marcos F.", numero: 50555, partido: "PSOL", votos: 1250 },
  { id: 'v5', nome: "Henry F.", numero: 77778, partido: "SD", votos: 1100 },
  { id: 'v6', nome: "Lucas Jr.", numero: 27000, partido: "DC", votos: 1080 },
  { id: 'v7', nome: "Michael N.", numero: 45555, partido: "PSDB", votos: 900 },
  { id: 'v8', nome: "Thaise G.", numero: 11111, partido: "PP", votos: 850 }
];

// Configurações
const TOTAL_URNAS = 500;
let urnasApuradas = 0;
let intervalId = null;
let isPaused = false;

// --- INICIALIZAÇÃO DO DOM ---
function createCards(data, containerId) {
  const container = document.getElementById(containerId);
  container.innerHTML = '';
  
  data.forEach((c, index) => {
    const card = document.createElement('div');
    card.className = 'candidate-card';
    card.id = c.id;
    // Posicionamento inicial
    card.style.top = `${index * (80 + 12)}px`; // altura + gap
    
    card.innerHTML = `
      <div class="c-pos">${index + 1}º</div>
      <div class="c-img"><i class="fas fa-user"></i></div>
      <div class="c-info">
        <span class="c-name">${c.nome}</span>
        <span class="c-party">${c.numero} • ${c.partido}</span>
      </div>
      <div class="c-votes">
        <span class="c-pct">0.00%</span>
        <span class="c-abs">${c.votos.toLocaleString()} votos</span>
      </div>
      <div class="bar-container">
        <div class="bar-fill" style="width: 0%"></div>
      </div>
    `;
    container.appendChild(card);
  });
}

createCards(prefeitos, 'containerPref');
createCards(vereadores, 'containerVer');

// --- MOTOR DE APURAÇÃO ---
function startApuracao() {
  intervalId = setInterval(() => {
    if (isPaused || urnasApuradas >= TOTAL_URNAS) return;
    
    urnasApuradas++;
    
    // Injeta votos "normais" (aleatórios pequenos)
    injetarVotos(prefeitos, 50, 200);
    injetarVotos(vereadores, 20, 100);
    
    // 5% de chance de ocorrer uma virada automática pequena
    if (Math.random() < 0.05) triggerMinorTwist();
    
    updateScreen();
    
    if (urnasApuradas === TOTAL_URNAS) {
      document.getElementById('tickerText').textContent = "APURAÇÃO ENCERRADA • RESULTADOS OFICIAIS DEFINIDOS";
      clearInterval(intervalId);
    }
  }, 1500); // Atualiza a cada 1.5s
}

function injetarVotos(lista, min, max) {
  lista.forEach(c => {
    // Adiciona votos aleatórios
    const novosVotos = Math.floor(Math.random() * (max - min + 1)) + min;
    c.votos += novosVotos;
  });
}

// --- ATUALIZAÇÃO VISUAL (ONDE A MÁGICA ACONTECE) ---
function updateScreen() {
  const pctUrnas = (urnasApuradas / TOTAL_URNAS) * 100;
  document.getElementById('urnasPref').textContent = pctUrnas.toFixed(1) + '%';
  document.getElementById('urnasVer').textContent = pctUrnas.toFixed(1) + '%';
  
  // Calcular total de votos para porcentagem
  const totalVotosPref = prefeitos.reduce((acc, c) => acc + c.votos, 0);
  document.getElementById('votosPref').textContent = totalVotosPref.toLocaleString();
  const totalVotosVer = vereadores.reduce((acc, c) => acc + c.votos, 0);

  updatePanel(prefeitos, totalVotosPref, 'containerPref');
  updatePanel(vereadores, totalVotosVer, 'containerVer');
}

function updatePanel(lista, totalVotos, containerId) {
  // 1. Ordenar dados (cópia para não perder referência se precisasse)
  // Mas aqui vamos ordenar a lista original para saber o ranking
  const ranking = [...lista].sort((a, b) => b.votos - a.votos);
  
  // 2. Aplicar mudanças no DOM
  ranking.forEach((c, index) => {
    const card = document.getElementById(c.id);
    
    // Mover Card (Animação CSS cuida da transição)
    const topPos = index * (80 + 12);
    card.style.top = `${topPos}px`;
    
    // Atualizar Posição
    const posEl = card.querySelector('.c-pos');
    posEl.textContent = `${index + 1}º`;
    
    // Atualizar Estilos de Líder
    if (index === 0) {
      card.classList.add('rank-1');
    } else {
      card.classList.remove('rank-1');
    }
    
    // Atualizar Números
    const pct = totalVotos > 0 ? (c.votos / totalVotos * 100).toFixed(2) : "0.00";
    card.querySelector('.c-pct').textContent = `${pct}%`;
    card.querySelector('.c-abs').textContent = `${c.votos.toLocaleString()} votos`;
    card.querySelector('.bar-fill').style.width = `${pct}%`;
  });
}

// --- SISTEMA DE REVIRAVOLTAS ---
function forcarVirada() {
  if (urnasApuradas >= TOTAL_URNAS) return alert("Apuração já encerrada!");

  // Efeito Visual
  const overlay = document.getElementById('fxOverlay');
  overlay.classList.add('active');
  setTimeout(() => overlay.classList.remove('active'), 1000);
  
  // Notícia
  const frases = [
    "URGENTE: URNAS DA ZONA SUL CHEGAM E MUDAM O CENÁRIO!",
    "REVIRAVOLTA: CANDIDATO GANHA FORÇA INESPERADA!",
    "ATENÇÃO: MATEMÁTICA ELEITORAL MUDA COM NOVOS DADOS!"
  ];
  const fraseEscolhida = frases[Math.floor(Math.random() * frases.length)];
  const ticker = document.getElementById('tickerText');
  ticker.textContent = fraseEscolhida;
  ticker.style.color = "var(--gold)";
  
  // Lógica de Virada (Prefeito)
  realizarVirada(prefeitos);
  // Lógica de Virada (Vereador)
  realizarVirada(vereadores);
  
  updateScreen();
}

function realizarVirada(lista) {
  // Ordenar atual
  let ranking = [...lista].sort((a, b) => b.votos - a.votos);
  
  // Pegar o 1º e o 2º
  const primeiro = ranking[0];
  const segundo = ranking[1];
  
  if (!segundo) return; // Segurança
  
  // Calcular diferença
  const diferenca = primeiro.votos - segundo.votos;
  
  // Dar ao segundo votos suficientes para passar o primeiro + um extra aleatório
  const boost = diferenca + Math.floor(Math.random() * 2000) + 500;
  
  segundo.votos += boost;
  
  // Às vezes, impulsionar um underdog (3º ou 4º lugar)
  if (Math.random() > 0.5 && ranking[2]) {
     ranking[2].votos += boost * 0.8; // O 3º lugar também sobe muito
  }
}

function triggerMinorTwist() {
    // Pequena turbulência aleatória sem apertar o botão
    const ticker = document.getElementById('tickerText');
    ticker.textContent = "NOVAS PARCIAIS INDICAM DISPUTA ACIRRADA NOS BAIRROS PERIFÉRICOS...";
    
    // Escolhe um candidato aleatório (exceto o primeiro) e dá um boost
    const randomIdx = Math.floor(Math.random() * (prefeitos.length - 1)) + 1;
    prefeitos[randomIdx].votos += 1500;
}

// Controles
document.getElementById('btnPause').addEventListener('click', function() {
  isPaused = !isPaused;
  this.innerHTML = isPaused ? '<i class="fas fa-play"></i> Continuar' : '<i class="fas fa-pause"></i> Pausar';
});

document.getElementById('btnChaos').addEventListener('click', forcarVirada);

// Iniciar
startApuracao();

</script>
</body>
</html>
